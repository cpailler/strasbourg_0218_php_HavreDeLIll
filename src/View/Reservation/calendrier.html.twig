{% extends 'layout.html.twig' %}
{% block title %}Page de localisation{% endblock %}
{% block stylesheet %}
    <link rel="stylesheet" href="/assets/css/formulaire_reservation.css">{% endblock %}



  {% block content %}




<section>
      <div class="container-fluid">
          <div class="row">
              <div class="col-xs-12">
                  <h1>RÉSERVATION / BOOKING</h1>
              </div>
          </div>
          <br>
          <br>
          <div class="row">
              <div class="col-xs-6">
                  <form action="">

                      <!--  Details -->
                      <div class="form-group">
                          <h2>Details</h2>
                          <div class="row">
                              <div class="col-xs-6">
                                  <div class="controls">
                                      <label for="arrive" class="label-date">&nbsp;&nbsp;Arrive</label>
                                      <input type="date" id="arrive" class="form-control dateclic" name="arrive"
                                              value="">
                                  </div>
                              </div>
                              <div class="col-xs-6">
                                  <div class="controls">
                                      <label for="depart" class="label-date">&nbsp;&nbsp;Depart</label>
                                      <input type="date" id="depart" class="form-control dateclic" name="depart"
                                             value=""/>
                                  </div>
                              </div>
                          </div>
                          <br>
                          <div class="row">
                              <div class="col-xs-6">
                                  <div class="controls">
                                      <label for="bedrooms">Chambres / bedrooms</label>
                                      <select class="form-control">
                                          <option value="gretel" selected>CHAMBRE GRETEL</option>
                                          <option value="veil">CHAMBRE SIMONE VEIL</option>
                                          <option value="hansel" selected>CHAMBRE HÄNSEL</option>
                                          <option value="schuman">CHAMBRE ROBERT SCHUMAN</option>
                                      </select>
                                  </div>
                              </div></br>
                              <div >
                                <h1 id="nbNuite">Nombre Nuités : <span></span></h1>
                              </div>

                          </div>
                      </div> <!-- /.form-group -->

                      <!--  General -->
                      <div class="form-group">
                          <h2>Réservation & contact / Booking & contact</h2>
                          <div class="input-group">
                              <span class="input-group-addon" id="">Nom / Name</span>
                              <input type="text" class="form-control">
                          </div>
                          <br>
                          <div class="input-group">
                              <span class="input-group-addon" id="">@</span>
                              <input type="text" class="form-control">
                          </div>
                          <br>
                          <div class="input-group">
                              <span class="input-group-addon" id="">Téléphone / Phone</span>
                              <input type="text" class="form-control">
                          </div>
                          </br>
                          <button type="submit" class="">Réserver</button>
                      </div>
                  </form>
              </div>
              <div class="col-xs-6">
                  <div class="col-md-9">
                      <div class="row">
                          <div class="col-md-10">
                              <h1>{{ monthTS }}</h1>
                          </div>
                          <div class="col-md-2">
                              <p></p> <a href="/Reservation/{{ previousMonth }}/{{ previousYear }}"
                                         class="btn-calender">&lt;</a>
                              <a href="/Reservation/{{ nextMonth }}/{{ nextYear }}" class="btn-calender">&gt;</a></p>
                          </div>

                      </div>


                      <table class="calendar__table calendar__table--{{ month.getweeks() }}weeks">
                          {% set date = cloneStart.modify("-1 day") %}
                          {% for i in 0..weeks %}
                              <tr>
                                  {% for k, day in days %}

                                      {% if i == 0 %}

                                      <td class="{% if (month.withinMonth(date)) %}{% else %}calendar__otherMonth{% endif %}">
                                          <div class="calendar__weekday">{{ day }}</div>
                                      {% else %}
                                          {% set date = date.modify("+1 day") %}

                                          <td class="{% if (month.withinMonth(date)) %}  {% else %}calendar__otherMonth{% endif %}">
                                          <div class="calendar__day">{{ date.format('d') }}</div>
                                          {% for reservation in ReservationForDay %}

                                              <div class="calendar__event">

                                                  {{ reservation.0.start }}


                                              </div>
                                          {% endfor %}
                                      {% endif %}



                                      </td>
                                  {% endfor %}
                              </tr>
                          {% endfor %}
                      </table>
                  </div>
              </div>
          </div>
      </div>
</section>


  {% endblock %}
{% block javascript %}
<script>
    $( '.dateclic' ).on('change',function() {

        var date1 = $('#arrive').val();
        var date2 = $('#depart').val();
        if (date1 == 'undefined' && date2 == 'undefined') {
            $('#nuite').val(0);
        }
        else {


            // First we split the values to arrays date1[0] is the year, [1] the month and [2] the day
            date1 = date1.split('-');
            date2 = date2.split('-');

            // Now we convert the array to a Date object, which has several helpful methods
            date1 = new Date(date1[0], date1[1], date1[2]);
            date2 = new Date(date2[0], date2[1], date2[2]);

            // We use the getTime() method and get the unixtime (in milliseconds, but we want seconds, therefore we divide it through 1000)
            date1_unixtime = parseInt(date1.getTime() / 1000);
            date2_unixtime = parseInt(date2.getTime() / 1000);

            // This is the calculated difference in seconds
            var timeDifference = (date2_unixtime - date1_unixtime);

            // in Hours
            var timeDifferenceInHours = timeDifference / 60 / 60;

            // and finaly, in days :)
            var timeDifferenceInDays = timeDifferenceInHours / 24;
            if (timeDifferenceInDays <= 0) {
                $('#nbNuite').replaceWith(`<h1 id="nbNuite"><span>Nombre Nuités :0</span></h1>`);
            } else {
                $('#nbNuite').replaceWith(`<h1 id="nbNuite"><span>Nombre Nuités :${timeDifferenceInDays}</span></h1>`);

            }


        }
    });
</script>
{% endblock %}